
# ðŸŒ³ Case Study #7: Balanced Tree

## ðŸ“˜ Problem Summary

Balanced Tree is an online eco-friendly retailer selling sustainable products. 
This case study analyzes customer purchase behavior, product categories, monthly revenue trends, and customer lifetime value.

## ðŸ§° Tools Used

- SQL (PostgreSQL / MySQL compatible)
- Joins
- Aggregations
- Common Table Expressions (CTEs)
- CASE Statements
- Lifetime Value (LTV) Calculations

## ðŸ“‘ Table of Contents
1. Total customers and transactions each month
2. Monthly revenue and growth trends
3. Revenue by product category
4. Customer segment purchase patterns
5. Customer lifetime value (LTV)
6. Top-selling products
7. Revenue split between categories

---

## ðŸ“Š Business Questions & SQL Solutions

### 1. What is the total number of customers and transactions each month?
Short Summary: Monthly customer and transaction trends.
```sql
SELECT
  DATE_TRUNC('month', order_date) AS month,
  COUNT(DISTINCT customer_id) AS total_customers,
  COUNT(order_id) AS total_transactions
FROM sales
GROUP BY month
ORDER BY month;
```

### 2. What is the monthly revenue and revenue growth trend?
Short Summary: Monthly sales revenue and growth rate.
```sql
WITH monthly_revenue AS (
  SELECT
    DATE_TRUNC('month', order_date) AS month,
    SUM(sale_amount) AS revenue
  FROM sales
  GROUP BY month
)
SELECT
  month,
  revenue,
  ROUND(
    (revenue - LAG(revenue) OVER (ORDER BY month)) / LAG(revenue) OVER (ORDER BY month) * 100, 2
  ) AS revenue_growth_percentage
FROM monthly_revenue;
```

### 3. What is the total revenue generated by each product category?
Short Summary: Revenue contribution by each product type.
```sql
SELECT
  ph.category_name,
  SUM(s.sale_amount) AS total_revenue
FROM sales s
JOIN product_details pd
  ON s.product_id = pd.product_id
JOIN product_hierarchy ph
  ON pd.category_id = ph.category_id
GROUP BY ph.category_name
ORDER BY total_revenue DESC;
```

### 4. What are the purchase patterns across different customer segments?
Short Summary: Buying behavior based on customer groups.
```sql
SELECT
  cs.segment_name,
  COUNT(s.order_id) AS total_orders,
  SUM(s.sale_amount) AS total_spent
FROM sales s
JOIN customer_segments cs
  ON s.customer_id = cs.customer_id
GROUP BY cs.segment_name
ORDER BY total_spent DESC;
```

### 5. What is the customer lifetime value (LTV) for each customer?
Short Summary: Total value generated per customer.
```sql
SELECT
  customer_id,
  SUM(sale_amount) AS lifetime_value
FROM sales
GROUP BY customer_id
ORDER BY lifetime_value DESC;
```

### 6. Which are the top-selling products?
Short Summary: Top products by number of units sold.
```sql
SELECT
  pd.product_name,
  COUNT(s.order_id) AS units_sold
FROM sales s
JOIN product_details pd
  ON s.product_id = pd.product_id
GROUP BY pd.product_name
ORDER BY units_sold DESC
LIMIT 10;
```

### 7. What percentage of revenue is contributed by each product category?
Short Summary: Revenue split by category.
```sql
WITH category_revenue AS (
  SELECT
    ph.category_name,
    SUM(s.sale_amount) AS revenue
  FROM sales s
  JOIN product_details pd
    ON s.product_id = pd.product_id
  JOIN product_hierarchy ph
    ON pd.category_id = ph.category_id
  GROUP BY ph.category_name
)
SELECT
  category_name,
  revenue,
  ROUND(revenue * 100.0 / SUM(revenue) OVER (), 2) AS revenue_percentage
FROM category_revenue
ORDER BY revenue_percentage DESC;
```

---

## ðŸ§  Key Learnings

- Monthly cohort analysis and revenue growth tracking.
- Product and category level revenue analysis.
- Customer segmentation and LTV calculation.

## ðŸŽ¯ Skills Practiced

| Skill |
|:------|
| SQL Joins |
| Aggregations |
| CTEs |
| Revenue Growth Analysis |
| Customer Segmentation |
| Lifetime Value Calculations |
